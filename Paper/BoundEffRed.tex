\documentclass[journal]{IEEEtran}

\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{euscript}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{color}
\usepackage{graphicx}
\usepackage{mathrsfs}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{dsfont}
\usepackage[shortlabels]{enumitem}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{hyperref}
\usepackage{mathpazo}
\usepackage{array}
\usepackage{bigints}

\graphicspath{{figures/}}
\input{mydefs}

\title{An Efficient Forecasting Approach\\ to Reduce Boundary Effects in Real-Time Time-Frequency Analysis}

\author{Adrien~Meynard, %~\IEEEmembership{Member,~IEEE,}
        Hau-Tieng~Wu
\thanks{A. Meynard is with the Department
of Mathematics, Duke University, Durham,
NC, 27708 USA.

H.-T. Wu is with the Department of Mathematics and Department of Statistical Science, Duke University, Durham, NC, 27708 USA; Mathematics Division, National Center for Theoretical Sciences, Taipei, Taiwan.
 
A. Meynard is the corresponding author (e-mail: adrien.meynard@duke.edu).
}}

\newtheorem{remark}{Remark}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}

\begin{document}

\maketitle

\begin{abstract}
Time-frequency (TF) representations of time series are intrinsically subject to the boundary effects. As a result, the structures of signals that are highlighted by the representations are garbled when approaching the boundaries of the TF domain. In this paper, for the purpose of real-time TF information acquisition of nonstationary oscillatory time series, we propose a numerically efficient approach for the reduction of such boundary effects. The solution relies on an extension of the analyzed signal obtained by a forecasting technique. In the case of the study of a class of locally oscillating signals, we provide a theoretical guarantee of the performance of our approach. Following a numerical verification of the algorithmic performance of our approach, we validate it by implementing it on biomedical signals.
\end{abstract}

\begin{IEEEkeywords}
Boundary effects, time-frequency, forecasting, nonstationarity
\end{IEEEkeywords}

\section{Introduction}
\label{se:introduction}
\IEEEPARstart{I}{n} any digital acquisition system, the study and the interpretation of the measured signals generally require an analysis tool, which enables researchers to point out the useful characteristics of the signal. The need for signal analysis arises from various signals, ranging from audio~\cite{Stowell18computational,Muller11signal}, mechanical~\cite{Peng02vibration}, or biomedical signals~\cite{Akay96detection}. For instance, biomedical signals, such as photoplethysmogram (PPG), contain several characteristics, including respiratory rate or blood pressure, that cannot be interpreted from its run-sequence plot in the time domain. An analysis tool would make possible the extraction of these useful characteristics. 

Usually, the measured signals exhibit nonstationary behavior, and the observed quantities might be interfered with by transient phenomena that can vary rapidly and irregularly. In this paper, we focus on oscillatory time series. These signals might, for example, oscillate fast with large amplitudes at one moment, and then oscillate slowly with small amplitudes at the next moment. In order to adapt the analysis to nonstationarities, local spectral analysis is generally performed~\cite{Stoica05spectral,Matz97generalized}. The short-time Fourier transform~\cite{Grochenig01foundations} (STFT), a typical tool built for this purpose, enables the determination of the local frequency content of a nonstationary signal.

Windowing is a common method for performing local analysis. Among many others, STFT~\cite{Flandrin:1999}, continuous wavelet transform (CWT)~\cite{Da1992}, synchrosqueezing transform (SST) \cite{Daubechies11synchrosqueezed}, and reassignment~\cite{Auger13time} (RS) are representations that fall back on the use of an analysis window. Let $x:I\to\RR$ denote the observed signal, where $I$ denotes the finite interval where the signal is measured. Let $g_s:\RR\to\RR$ denote the analysis window, where $s$ is a shape parameter. The support of $g_s$ is localized around the origin and is small with respect to $|I|$. The translation operator is $T_\tau$ defined as:
\[
T_\tau f = f(t-\tau)\ ,\quad \forall\ f:\RR\to\RR\ .
\]
Then, the local analysis of $x$ around the instant $\tau\in I$ rely on the evaluation of the following inner product:
\begin{equation}
V_x(s,\tau) = \langle x, T_\tau g_s \rangle_I \ .
\label{eq:windowing}
\end{equation}
A major shortcoming of this technique occurs when analyzing the signal $x$ {\em near the boundaries} of the interval $I$. Clearly, at these points, half of the information is missing. Consequently, the results of the inner product~\eqref{eq:windowing} are distorted. This phenomenon is usually understood as the \emph{boundary effect}. The result of the SST of a PPG is shown in the lower-left corner of Fig.~\ref{fig:ex.intro} (see section~\ref{ssse:ppg} for a comprehensive description). The distortion resulting from boundary effects is clearly visible on the right side of this representation---this area is highlighted by the red dashed rectangle. Indeed, while in the major left part of the image, clear lines stand out, they become blurred as they approach the right boundary of the image. Therefore, estimations of signal characteristics, like instantaneous frequencies~\cite{Delprat92asymptotic} or amplitudes, from this TF representation appear to be imprecisely determinable (or even likely to fail) in the vicinity of the boundaries. Moreover, this boundary effect would unavoidably limit applying these window-based TF analysis tools for real-time analysis purposes. It is thus desirable to have a solution to eliminating the boundary effects.

\begin{figure}
\centering
\includegraphics[width=.48\textwidth]{PPGsig.eps}
\caption{A segment of PPG signal (top) and the right boundary of a TF representation determined by the SST without extension (bottom left), and the right boundary of a TF representation determined by the SST with the proposed boundary effect reduction algorithm by forecasting (bottom right). The window length for the SST is 12~seconds. {\color{red}Videos of these real-time SSTs are available online at \url{https://github.com/AdMeynard/BoundaryEffectsReduction}.}}
\label{fig:ex.intro}
\end{figure}

Attempts to minimize the boundary effects generally consists in softening the discontinuity on signal edges. Usually, the approaches can be classified into two main classes, choosing a proper analysis window and extending/forecasting the signal. In the first class, judicious choice of analysis window whose support does not interfere with the boundary points can minimize the occurrence of aberrant patterns near the boundaries of the TF plane, for instance, \cite{Chui92wavelets,Depczynski99fast}. Due to the specific relationship between the chosen analysis windows and the TF analysis tool, these techniques do not make it possible to reduce the boundary effects of all TF representations. 
%
Another natural idea, the second class, consists of carrying out a preliminary step of extending, or forecasting, the signal beyond its boundaries. Due to its flexibility, various forecasting schemes have been proposed. For example, there exist simple extension schemes that do not take into account the dynamical behavior of the signal, such as zero-padding, periodic extension, symmetric extension~\cite{Kharitonenko02wavelet,Chen95symmetric}, or polynomial extrapolation~\cite{Williams97discrete}. 
%
There exist extension schemes based on physically relevant dynamical models, such as the Extended Dynamic Mode Decomposition~\cite{Williams15data} (EDMD) and the Gaussian process regression~\cite{Rasmussen06gaussian,Roberts13Gaussian} (GPR).
%
{\color{red}
In speech processing, dynamic mode predictors have also been proposed~\cite{Vargas11speech} to forecast signals falling into the so-called \textit{source--filter} model. This gradient-based technique rely on the shadowing approach proposed in~\cite{Grebogi90shadowing}.
}
%
There also exist extension schemes based on stochastic models, such as the Trigonometric, Box-Cox transformation, ARMA errors, Trend and Seasonal components (TBATS) algorithm~\cite{DeLivera11forecasting}, the dynamic linear models \cite{west2006bayesian}. 
%
In the physically relevant dynamical models, the oscillation or trend, are usually modeled as the mean of a stochastic process, while in the stochastic models, the oscillation or trend are modeled by the covariance structure of the stochastic process. 
It is also possible to consider polynomial regression~\cite{fan1996local} or modeling the mean by splines~\cite{hall2005theory}, kernel functions~\cite{chang2010training}, and wavelets~\cite{marron1998exact}, or nonparametric regression~\cite{fan1996local}, to estimate the mean function before forecasting the signal. Neural network models, such as the long short-term memory model~\cite{vlachas2018data}, is another approach. 
%
The above list is far from exhaustive, and we refer readers with interest to \cite{hyndman2018forecasting} for a friendly monograph on the general forecasting topic. 
%
While the model-based extension scheme gives better-extended signals than those simple extension without dynamical models, they generally have a great computational cost. 

In this paper, we propose a fast extension algorithm based on a simple dynamical model that optimizes the trade-off between the extension quality and the computational cost, so that the real-time analysis can be achieved. The algorithm is composed of two steps.
\begin{enumerate}
\item \emph{Extend the signal by forecasting it.} The aim is to use a simple dynamic model to predict the values taken by the measured signal outside the measurement interval. Then, once this operation is done, we have access to an extended signal defined on a larger interval $I_\Delta$, where $\Delta$ denotes the size of the extension on both boundaries of $I$.
\item \emph{Run the local analysis tool on the extended signal.} Assuming that the support of the analysis window is smaller than $2\Delta$, the local analysis near the boundary of $I$ is now possible without lack of information thanks to knowledge brought by the extension. 
\end{enumerate}

Thus, assuming that the quality of the extension step is sufficient, the analysis results obtained that way will be less sensitive to the boundary effects than the result of the analysis tool applied directly to the nonextended signal. We claim and prove that forecasting oscillatory signals based on the simple dynamical model combined with the simple least square approach is sufficient for reducing the boundary effects for the TF analysis, or other kernel-based analysis. To our knowledge, such theoretical analysis does not exist in the literature. See the bottom of Fig.~\ref{fig:ex.intro}---in particular, the regions indicated by the dashed boxes---for a snapshot of the result. The main benefit of this simple approach is a numerically efficient solution with a theoretical guarantee for real-time analysis purposes. 

The paper is organized in the following way. In section~\ref{se:algo}, we provide an extension method based on a linear dynamic model. We derive the corresponding algorithm for boundary effects reduction. In section~\ref{se:theoretical}, we show that the dynamic model we consider is sufficient to extend signals taking the form of sums of sine waves. An evaluation of the theoretical performance of our algorithm on this class of signals is given in section~\ref{se:theoretical}. In section~\ref{se:results}, we compare our extension method with more sophisticated methods such as EDMD, GPR, or TBATS. We show that our algorithm gives fast results of reasonable quality. Finally, we evaluate the performance of our boundary effects reduction algorithm on biomedical signals, such as respiratory signals, and compare it to the theoretical results. 

\section{Algorithm}
\label{se:algo}
\input{algorithm}


\section{Theoretical Performance}
\label{se:theoretical}
\input{theory}

\section{Numerical Results}
\label{se:results}
\input{results}

\section{Conclusion}
\label{se:conclusion}
In this paper, we propose an algorithm, named {\sf BoundEffRed}, for the real-time reduction of boundary effects in TF representations. This method is based on an extension of the signal obtained by a simple-minded and numerically efficient forecasting. We have shown theoretically that the chosen dynamic model is sufficient to extend signals formed by a sum of sine waves. Moreover, the low computational time allows us to switch to a real-time implementation of {\sf BoundEffRed}, unlike other existing forecasting methods. The numerical results also confirmed the robustness to noise of {\sf BoundEffRed}, as well as its ability to be applied to many TF representations. Additional applications to ECG and PPG are included in the Supplementary Materials.

Various improvements can be considered to make the algorithm more robust. In particular, we have noticed (see Fig.~\ref{fig:THO.failure}) that when the regular oscillations of the observed signal break, the forecasting step is no longer relevant, and only slows down the calculation of the TF representation. A preliminary step should then be added to the algorithm to detect signal activity and disable the forecasting step when possible. More fundamentally, one can also consider accelerating the computational time by optimizing the forecasting step to improve the real-time performance of {\sf BoundEffRed}. Indeed, each new forecast requires the inversion of the matrix $\bX\bX^T$ of size $M\times M$. However, the matrix $\bX$ used to forecast $\bx_{N+H}$ at the current iteration differs from the one used at the previous iteration to forecast $\bx_{N}$ by only $H$ columns. It then seems natural to take inspiration from the work of Strobach~\cite{Strobach97square}, generalized by Badeau \etal~\cite{Badeau04sliding}, which proposes a fast algorithm for the singular value decomposition of successive data matrices taking the same form as $\bX$. Their algorithm is limited to the case where $H=1$. Developing an extension of this algorithm to variations of $H>1$ columns would then allow us to efficiently update the matrix $\left(\bX\bX^T\right)^{-1}$. These avenues will be explored in our future work.

%\appendices
%\input{appendices}

%\section*{Acknowledgment}

\bibliographystyle{IEEEtran}
\bibliography{AM041320}

%\begin{IEEEbiography}{Michael Shell}
%Biography text here.
%\end{IEEEbiography}
%
%\begin{IEEEbiographynophoto}{John Doe}
%Biography text here.
%\end{IEEEbiographynophoto}


\end{document}